{
  "openapi":"3.0.1",
  "info":{
    "title":"cwa-verification-server",
    "description":"OpenApi documentation of cwa-verification-server",
    "license":{
      "name":"Apache 2.0",
      "url":"http://www.apache.org/licenses/LICENSE-2.0"
    },
    "version":"0.3-alpha"
  },
  "servers":[
    {
      "url":"http://localhost:8080",
      "description":"Generated server url"
    }
  ],
  "paths":{
    "/version/v1/registrationToken":{
      "post":{
        "tags":[
          "verification-controller"
        ],
        "summary":"Get registration Token",
        "description":"Get a registration token by providing a SHA-256 hasehd GUID or a TeleTAN",
        "operationId":"generateRegistrationToken",
        "requestBody":{
          "content":{
            "application/json":{
              "schema":{
                "$ref":"#/components/schemas/RegistrationTokenRequest"
              }
            }
          },
          "required":true
        },
        "responses":{
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/RegistrationToken"
                }
              }
            }
          },
          "400":{
            "description":"GUID/TeleTAN already exists.",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/RegistrationToken"
                }
              }
            }
          },
          "200":{
            "description":"GUID/TeleTAN found",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/RegistrationToken"
                }
              }
            }
          }
        }
      }
    },
    "/version/v1/tan":{
      "post":{
        "tags":[
          "verification-controller"
        ],
        "summary":"Generates a Tan",
        "description":"Generates a TAN on input of Registration Token. With the TAN one can submit his Diagnosis keys",
        "operationId":"generateTan",
        "requestBody":{
          "content":{
            "application/json":{
              "schema":{
                "$ref":"#/components/schemas/RegistrationToken"
              }
            }
          },
          "required":true
        },
        "responses":{
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/RegistrationToken"
                }
              }
            }
          },
          "400":{
            "description":"Registration Token does not exist",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/Tan"
                }
              }
            }
          },
          "201":{
            "description":"Registration Token is valid",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/Tan"
                }
              }
            }
          }
        }
      }
    },
    "/version/v1/testresult":{
      "post":{
        "tags":[
          "verification-controller"
        ],
        "summary":"COVID-19 test result",
        "description":"Gets the result of COVID-19 Test.",
        "operationId":"getTestState",
        "requestBody":{
          "content":{
            "application/json":{
              "schema":{
                "$ref":"#/components/schemas/RegistrationToken"
              }
            }
          },
          "required":true
        },
        "responses":{
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/RegistrationToken"
                }
              }
            }
          },
          "400":{
            "description":"Bad Request",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/TestResult"
                }
              }
            }
          },
          "200":{
            "description":"Testresult retrieved",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/TestResult"
                }
              }
            }
          }
        }
      }
    },
    "/version/v1/tan/verify":{
      "post":{
        "tags":[
          "verification-controller"
        ],
        "summary":"Verify provided Tan",
        "description":"The provided Tan is verified to be formerly issued by the verification server",
        "operationId":"verifyTan",
        "requestBody":{
          "content":{
            "application/json":{
              "schema":{
                "$ref":"#/components/schemas/Tan"
              }
            }
          },
          "required":true
        },
        "responses":{
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/RegistrationToken"
                }
              }
            }
          },
          "400":{
            "description":"Bad Request",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/TestResult"
                }
              }
            }
          },
          "200":{
            "description":"Tan is valid an formerly issued by the verification server"
          },
          "404":{
            "description":"Tan could not be verified"
          }
        }
      }
    },
    "/version/v1/tan/teletan":{
      "post":{
        "tags":[
          "verification-controller"
        ],
        "summary":"Request generation of a TeleTan",
        "description":"A TeleTan is a human readable TAN with 7 characters which is supposed to be issued via call line",
        "operationId":"createTeleTan",
        "responses":{
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/RegistrationToken"
                }
              }
            }
          },
          "400":{
            "description":"Bad Request",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/TestResult"
                }
              }
            }
          },
          "201":{
            "description":"TeleTan created"
          }
        }
      }
    }
  },
  "components":{
    "schemas":{
      "RegistrationTokenRequest":{
        "type":"object",
        "properties":{
          "key":{
            "type":"string"
          },
          "keyType":{
            "type":"string",
            "enum":[
              "GUID",
              "TELETAN"
            ]
          }
        }
      },
      "RegistrationToken":{
        "type":"object",
        "properties":{
          "registrationToken":{
            "type":"string"
          }
        }
      },
      "Tan":{
        "type":"object",
        "properties":{
          "tan":{
            "type":"string"
          }
        }
      },
      "TestResult":{
        "type":"object",
        "properties":{
          "testResult":{
            "type":"integer",
            "format":"int32"
          }
        }
      }
    }
  }
}
